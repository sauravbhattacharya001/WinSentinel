<Page x:Class="WinSentinel.App.Views.PolicySettingsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Background="{StaticResource AppBackground}">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="32" MaxWidth="800">
            <!-- Header -->
            <TextBlock Text="ðŸ›¡ï¸ Security Policy Settings" FontSize="28" FontWeight="Bold" 
                      Foreground="{StaticResource TextPrimary}" Margin="0,0,0,8" />
            <TextBlock Text="Configure how the agent responds to threats, notifications, and scanning behavior."
                      Foreground="{StaticResource TextSecondary}" FontSize="14" Margin="0,0,0,24" />

            <!-- Agent Connection Status -->
            <Border x:Name="ConnectionBanner" Background="#2A1A1A" CornerRadius="8" Padding="16,10" Margin="0,0,0,16"
                    Visibility="Collapsed">
                <TextBlock x:Name="ConnectionBannerText" Text="âš ï¸ Not connected to agent â€” settings shown are defaults"
                          Foreground="#FF9800" FontSize="13" />
            </Border>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- RISK TOLERANCE -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border Background="{StaticResource CardBackground}" CornerRadius="12" Padding="24"
                    BorderBrush="{StaticResource CardBorder}" BorderThickness="1" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="âš–ï¸ Risk Tolerance" FontSize="20" FontWeight="SemiBold"
                              Foreground="{StaticResource TextPrimary}" Margin="0,0,0,4" />
                    <TextBlock Text="Controls how aggressively the agent responds to threats."
                              Foreground="{StaticResource TextSecondary}" FontSize="13" Margin="0,0,0,16" />

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <RadioButton x:Name="RiskLow" Content="ðŸ”’ Low" GroupName="Risk"
                                    Foreground="{StaticResource TextPrimary}" FontSize="14" FontWeight="SemiBold"
                                    Margin="0,0,32,0" Checked="Risk_Changed" />
                        <RadioButton x:Name="RiskMedium" Content="âš–ï¸ Medium" GroupName="Risk"
                                    Foreground="{StaticResource TextPrimary}" FontSize="14" FontWeight="SemiBold"
                                    Margin="0,0,32,0" Checked="Risk_Changed" />
                        <RadioButton x:Name="RiskHigh" Content="ðŸ“‹ High" GroupName="Risk"
                                    Foreground="{StaticResource TextPrimary}" FontSize="14" FontWeight="SemiBold"
                                    Checked="Risk_Changed" />
                    </StackPanel>

                    <Border x:Name="RiskDescriptionBox" Background="#1A1A2E" CornerRadius="8" Padding="12,8" Margin="0,4,0,0">
                        <TextBlock x:Name="RiskDescriptionText" TextWrapping="Wrap"
                                  Foreground="{StaticResource TextSecondary}" FontSize="13"
                                  Text="Agent alerts on critical+high threats, logs the rest." />
                    </Border>
                </StackPanel>
            </Border>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- PER-CATEGORY TOGGLES -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border Background="{StaticResource CardBackground}" CornerRadius="12" Padding="24"
                    BorderBrush="{StaticResource CardBorder}" BorderThickness="1" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="ðŸ“‚ Per-Category Policies" FontSize="20" FontWeight="SemiBold"
                              Foreground="{StaticResource TextPrimary}" Margin="0,0,0,4" />
                    <TextBlock Text="Configure auto-fix and default response for each threat category."
                              Foreground="{StaticResource TextSecondary}" FontSize="13" Margin="0,0,0,16" />

                    <ItemsControl x:Name="CategoryList" />
                </StackPanel>
            </Border>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- USER OVERRIDES -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border Background="{StaticResource CardBackground}" CornerRadius="12" Padding="24"
                    BorderBrush="{StaticResource CardBorder}" BorderThickness="1" Margin="0,0,0,16">
                <StackPanel>
                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0">
                            <TextBlock Text="ðŸŽ¯ User Overrides" FontSize="20" FontWeight="SemiBold"
                                      Foreground="{StaticResource TextPrimary}" />
                            <TextBlock Text="Custom rules for specific threat types (created via chat or manually)."
                                      Foreground="{StaticResource TextSecondary}" FontSize="13" Margin="0,4,0,0" />
                        </StackPanel>
                        <Button Grid.Column="1" Content="âž• Add Override" Style="{StaticResource QuickButton}"
                                Click="AddOverride_Click" VerticalAlignment="Top" />
                    </Grid>

                    <ItemsControl x:Name="OverridesList" />

                    <TextBlock x:Name="NoOverridesText" Text="No user overrides configured."
                              Foreground="{StaticResource TextSecondary}" FontSize="13" FontStyle="Italic"
                              Margin="0,8,0,0" />
                </StackPanel>
            </Border>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- NOTIFICATION SETTINGS -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border Background="{StaticResource CardBackground}" CornerRadius="12" Padding="24"
                    BorderBrush="{StaticResource CardBorder}" BorderThickness="1" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="ðŸ”” Notifications" FontSize="20" FontWeight="SemiBold"
                              Foreground="{StaticResource TextPrimary}" Margin="0,0,0,12" />

                    <CheckBox x:Name="NotifyToastCheck" Content="Enable toast notifications"
                             Foreground="{StaticResource TextPrimary}" FontSize="14" Margin="0,0,0,8"
                             Checked="Settings_Changed" Unchecked="Settings_Changed" />
                    <CheckBox x:Name="NotifyCriticalOnlyCheck" Content="Critical severity only (ignore lower severities)"
                             Foreground="{StaticResource TextPrimary}" FontSize="14" Margin="20,0,0,8"
                             Checked="Settings_Changed" Unchecked="Settings_Changed" />
                    <CheckBox x:Name="NotifySoundCheck" Content="Play sound on notification"
                             Foreground="{StaticResource TextPrimary}" FontSize="14" Margin="0,0,0,8"
                             Checked="Settings_Changed" Unchecked="Settings_Changed" />
                    <CheckBox x:Name="NotifyScanCompleteCheck" Content="Notify when scheduled scan completes"
                             Foreground="{StaticResource TextPrimary}" FontSize="14"
                             Checked="Settings_Changed" Unchecked="Settings_Changed" />
                </StackPanel>
            </Border>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- SCHEDULED SCAN SETTINGS -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border Background="{StaticResource CardBackground}" CornerRadius="12" Padding="24"
                    BorderBrush="{StaticResource CardBorder}" BorderThickness="1" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="â° Scheduled Scanning" FontSize="20" FontWeight="SemiBold"
                              Foreground="{StaticResource TextPrimary}" Margin="0,0,0,12" />

                    <TextBlock Text="Scan Interval" Foreground="{StaticResource TextPrimary}" FontSize="14"
                              FontWeight="SemiBold" Margin="0,0,0,8" />
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                        <RadioButton x:Name="Scan1h" Content="1h" GroupName="ScanInterval"
                                    Foreground="{StaticResource TextPrimary}" FontSize="14"
                                    Margin="0,0,16,0" Checked="ScanInterval_Changed" />
                        <RadioButton x:Name="Scan4h" Content="4h" GroupName="ScanInterval"
                                    Foreground="{StaticResource TextPrimary}" FontSize="14"
                                    Margin="0,0,16,0" Checked="ScanInterval_Changed" />
                        <RadioButton x:Name="Scan8h" Content="8h" GroupName="ScanInterval"
                                    Foreground="{StaticResource TextPrimary}" FontSize="14"
                                    Margin="0,0,16,0" Checked="ScanInterval_Changed" />
                        <RadioButton x:Name="Scan12h" Content="12h" GroupName="ScanInterval"
                                    Foreground="{StaticResource TextPrimary}" FontSize="14"
                                    Margin="0,0,16,0" Checked="ScanInterval_Changed" />
                        <RadioButton x:Name="Scan24h" Content="24h" GroupName="ScanInterval"
                                    Foreground="{StaticResource TextPrimary}" FontSize="14"
                                    Checked="ScanInterval_Changed" />
                    </StackPanel>

                    <Separator Background="{StaticResource CardBorder}" Margin="0,4,0,12" />

                    <CheckBox x:Name="AutoExportCheck" Content="Auto-export report after scan"
                             Foreground="{StaticResource TextPrimary}" FontSize="14" Margin="0,0,0,8"
                             Checked="Settings_Changed" Unchecked="Settings_Changed" />
                    <StackPanel x:Name="ExportFormatPanel" Orientation="Horizontal" Margin="20,0,0,4">
                        <TextBlock Text="Format: " Foreground="{StaticResource TextSecondary}" FontSize="13"
                                  VerticalAlignment="Center" />
                        <ComboBox x:Name="ExportFormatCombo" Width="100" FontSize="13"
                                 Background="#2A2A4A" Foreground="{StaticResource TextPrimary}"
                                 BorderBrush="{StaticResource CardBorder}"
                                 SelectionChanged="ExportFormat_Changed">
                            <ComboBoxItem Content="HTML" IsSelected="True" />
                            <ComboBoxItem Content="JSON" />
                        </ComboBox>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- MONITOR MODULES -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border Background="{StaticResource CardBackground}" CornerRadius="12" Padding="24"
                    BorderBrush="{StaticResource CardBorder}" BorderThickness="1" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="ðŸ‘ï¸ Monitor Modules" FontSize="20" FontWeight="SemiBold"
                              Foreground="{StaticResource TextPrimary}" Margin="0,0,0,4" />
                    <TextBlock Text="Enable or disable individual monitoring modules in the agent."
                              Foreground="{StaticResource TextSecondary}" FontSize="13" Margin="0,0,0,12" />

                    <ItemsControl x:Name="MonitorModulesList" />
                </StackPanel>
            </Border>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <!-- SYSTEM SETTINGS -->
            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border Background="{StaticResource CardBackground}" CornerRadius="12" Padding="24"
                    BorderBrush="{StaticResource CardBorder}" BorderThickness="1" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="ðŸ–¥ï¸ System" FontSize="20" FontWeight="SemiBold"
                              Foreground="{StaticResource TextPrimary}" Margin="0,0,0,12" />

                    <CheckBox x:Name="StartWithWindowsCheck" Content="Start with Windows"
                             Foreground="{StaticResource TextPrimary}" FontSize="14" Margin="0,0,0,8"
                             Checked="Settings_Changed" Unchecked="Settings_Changed" />
                    <CheckBox x:Name="MinimizeToTrayCheck" Content="Minimize to tray on close"
                             Foreground="{StaticResource TextPrimary}" FontSize="14"
                             Checked="Settings_Changed" Unchecked="Settings_Changed" />
                </StackPanel>
            </Border>

            <!-- Save Button & Status -->
            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                <Button x:Name="SaveButton" Content="ðŸ’¾ Save All Settings" 
                        Style="{StaticResource AccentButton}" Click="SaveAll_Click"
                        MinWidth="180" Margin="0,0,16,0" />
                <Button x:Name="ResetButton" Content="ðŸ”„ Reset to Defaults"
                        Style="{StaticResource QuickButton}" Click="ResetDefaults_Click"
                        MinWidth="160" />
            </StackPanel>

            <TextBlock x:Name="StatusText" Text="" FontSize="13" Foreground="#4CAF50" 
                      Margin="0,4,0,24" />
        </StackPanel>
    </ScrollViewer>
</Page>
