<Page x:Class="WinSentinel.App.Views.SettingsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Background="{StaticResource AppBackground}">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="32" MaxWidth="800">
            <!-- Header -->
            <TextBlock Text="âš™ï¸ Scheduled Scanning" FontSize="28" FontWeight="Bold" 
                      Foreground="{StaticResource TextPrimary}" Margin="0,0,0,8" />
            <TextBlock Text="Configure automatic security scans to keep your system protected."
                      Foreground="{StaticResource TextSecondary}" FontSize="14" Margin="0,0,0,24" />

            <!-- Enable/Disable Toggle -->
            <Border Background="{StaticResource CardBackground}" CornerRadius="12" Padding="24"
                    BorderBrush="{StaticResource CardBorder}" BorderThickness="1" Margin="0,0,0,16">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Scheduled Scanning" FontSize="18" FontWeight="SemiBold"
                                  Foreground="{StaticResource TextPrimary}" />
                        <TextBlock Text="Automatically run security audits on a schedule"
                                  Foreground="{StaticResource TextSecondary}" Margin="0,4,0,0" />
                    </StackPanel>

                    <CheckBox x:Name="EnableToggle" Grid.Column="1" 
                             VerticalAlignment="Center" 
                             Checked="EnableToggle_Changed" Unchecked="EnableToggle_Changed"
                             Content="Enabled" FontSize="14"
                             Foreground="{StaticResource TextPrimary}" />
                </Grid>
            </Border>

            <!-- Scan Interval -->
            <Border x:Name="IntervalSection" Background="{StaticResource CardBackground}" CornerRadius="12" Padding="24"
                    BorderBrush="{StaticResource CardBorder}" BorderThickness="1" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="Scan Interval" FontSize="18" FontWeight="SemiBold"
                              Foreground="{StaticResource TextPrimary}" Margin="0,0,0,12" />

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <RadioButton x:Name="IntervalHourly" Content="Every Hour" GroupName="Interval"
                                    Foreground="{StaticResource TextPrimary}" FontSize="14"
                                    Margin="0,0,24,0" Checked="Interval_Changed" />
                        <RadioButton x:Name="IntervalDaily" Content="Every Day" GroupName="Interval"
                                    Foreground="{StaticResource TextPrimary}" FontSize="14"
                                    Margin="0,0,24,0" Checked="Interval_Changed" />
                        <RadioButton x:Name="IntervalCustom" Content="Custom" GroupName="Interval"
                                    Foreground="{StaticResource TextPrimary}" FontSize="14"
                                    Checked="Interval_Changed" />
                    </StackPanel>

                    <StackPanel x:Name="CustomIntervalPanel" Orientation="Horizontal" Margin="0,8,0,0" Visibility="Collapsed">
                        <TextBlock Text="Every " VerticalAlignment="Center"
                                  Foreground="{StaticResource TextSecondary}" FontSize="14" />
                        <TextBox x:Name="CustomMinutesBox" Width="80" Text="120" 
                                Background="#2A2A4A" Foreground="{StaticResource TextPrimary}"
                                BorderBrush="{StaticResource CardBorder}" Padding="8,6"
                                FontSize="14" TextChanged="CustomMinutes_Changed" />
                        <TextBlock Text=" minutes (minimum 5)" VerticalAlignment="Center"
                                  Foreground="{StaticResource TextSecondary}" FontSize="14" />
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Notification Settings -->
            <Border Background="{StaticResource CardBackground}" CornerRadius="12" Padding="24"
                    BorderBrush="{StaticResource CardBorder}" BorderThickness="1" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="ðŸ”” Notifications" FontSize="18" FontWeight="SemiBold"
                              Foreground="{StaticResource TextPrimary}" Margin="0,0,0,12" />

                    <CheckBox x:Name="NotifyCompleteCheck" Content="Notify when scheduled scan completes"
                             Foreground="{StaticResource TextPrimary}" FontSize="14" Margin="0,0,0,8"
                             Checked="Notification_Changed" Unchecked="Notification_Changed" />
                    <CheckBox x:Name="NotifyScoreDropCheck" Content="Notify when security score drops"
                             Foreground="{StaticResource TextPrimary}" FontSize="14" Margin="0,0,0,8"
                             Checked="Notification_Changed" Unchecked="Notification_Changed" />
                    <CheckBox x:Name="NotifyNewFindingsCheck" Content="Notify on new critical/warning findings"
                             Foreground="{StaticResource TextPrimary}" FontSize="14"
                             Checked="Notification_Changed" Unchecked="Notification_Changed" />
                </StackPanel>
            </Border>

            <!-- Module Selection -->
            <Border Background="{StaticResource CardBackground}" CornerRadius="12" Padding="24"
                    BorderBrush="{StaticResource CardBorder}" BorderThickness="1" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="ðŸ” Modules to Scan" FontSize="18" FontWeight="SemiBold"
                              Foreground="{StaticResource TextPrimary}" Margin="0,0,0,4" />
                    <TextBlock Text="Select which modules to include in scheduled scans. Leave all unchecked to scan everything."
                              Foreground="{StaticResource TextSecondary}" FontSize="13" Margin="0,0,0,12" />

                    <ItemsControl x:Name="ModulesList" />
                </StackPanel>
            </Border>

            <!-- System Tray Settings -->
            <TextBlock Text="ðŸ–¥ï¸ System Tray" FontSize="28" FontWeight="Bold" 
                      Foreground="{StaticResource TextPrimary}" Margin="0,16,0,8" />
            <TextBlock Text="Control how WinSentinel runs in the background."
                      Foreground="{StaticResource TextSecondary}" FontSize="14" Margin="0,0,0,24" />

            <Border Background="{StaticResource CardBackground}" CornerRadius="12" Padding="24"
                    BorderBrush="{StaticResource CardBorder}" BorderThickness="1" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="Tray Behavior" FontSize="18" FontWeight="SemiBold"
                              Foreground="{StaticResource TextPrimary}" Margin="0,0,0,12" />

                    <CheckBox x:Name="MinimizeToTrayCheck" Content="Minimize to tray on close (instead of exiting)"
                             Foreground="{StaticResource TextPrimary}" FontSize="14" Margin="0,0,0,8"
                             Checked="TraySettings_Changed" Unchecked="TraySettings_Changed" />
                    <CheckBox x:Name="StartMinimizedCheck" Content="Start minimized to tray"
                             Foreground="{StaticResource TextPrimary}" FontSize="14" Margin="0,0,0,8"
                             Checked="TraySettings_Changed" Unchecked="TraySettings_Changed" />
                    <CheckBox x:Name="ShowTrayNotificationsCheck" Content="Show tray balloon notifications"
                             Foreground="{StaticResource TextPrimary}" FontSize="14"
                             Checked="TraySettings_Changed" Unchecked="TraySettings_Changed" />
                </StackPanel>
            </Border>

            <Border Background="{StaticResource CardBackground}" CornerRadius="12" Padding="24"
                    BorderBrush="{StaticResource CardBorder}" BorderThickness="1" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="ðŸš€ Windows Startup" FontSize="18" FontWeight="SemiBold"
                              Foreground="{StaticResource TextPrimary}" Margin="0,0,0,4" />
                    <TextBlock Text="Launch WinSentinel automatically when Windows starts."
                              Foreground="{StaticResource TextSecondary}" FontSize="13" Margin="0,0,0,12" />

                    <CheckBox x:Name="StartWithWindowsCheck" Content="Start WinSentinel with Windows"
                             Foreground="{StaticResource TextPrimary}" FontSize="14" Margin="0,0,0,8"
                             Checked="StartWithWindows_Changed" Unchecked="StartWithWindows_Changed" />

                    <TextBlock x:Name="StartupStatusText" Text=""
                              Foreground="{StaticResource TextSecondary}" FontSize="13" Margin="0,4,0,0" />
                </StackPanel>
            </Border>

            <!-- Status & Actions -->
            <Border Background="{StaticResource CardBackground}" CornerRadius="12" Padding="24"
                    BorderBrush="{StaticResource CardBorder}" BorderThickness="1" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="ðŸ“Š Scheduler Status" FontSize="18" FontWeight="SemiBold"
                              Foreground="{StaticResource TextPrimary}" Margin="0,0,0,12" />

                    <TextBlock x:Name="LastScanText" Text="Last scan: Never"
                              Foreground="{StaticResource TextSecondary}" FontSize="14" Margin="0,0,0,4" />
                    <TextBlock x:Name="NextScanText" Text="Next scan: â€”"
                              Foreground="{StaticResource TextSecondary}" FontSize="14" Margin="0,0,0,4" />
                    <TextBlock x:Name="LastScoreText" Text="Last score: â€”"
                              Foreground="{StaticResource TextSecondary}" FontSize="14" Margin="0,0,0,12" />

                    <StackPanel Orientation="Horizontal">
                        <Button x:Name="ScanNowButton" Content="â–¶ Scan Now" 
                                Style="{StaticResource AccentButton}" Click="ScanNow_Click"
                                MinWidth="140" Margin="0,0,12,0" />
                        <Button x:Name="TestNotificationButton" Content="ðŸ”” Test Notification"
                                Style="{StaticResource QuickButton}" Click="TestNotification_Click"
                                MinWidth="160" />
                    </StackPanel>

                    <TextBlock x:Name="ScanStatusText" Text=""
                              Foreground="{StaticResource TextSecondary}" FontSize="13" 
                              Margin="0,8,0,0" />
                </StackPanel>
            </Border>

            <!-- Save Reminder -->
            <TextBlock x:Name="SavedText" Text="" FontSize="13" Foreground="#4CAF50" 
                      Margin="0,0,0,16" />
        </StackPanel>
    </ScrollViewer>
</Page>
